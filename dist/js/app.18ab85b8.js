(function(t){function e(e){for(var n,s,r=e[0],l=e[1],c=e[2],d=0,p=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,r=1;r<a.length;r++){var l=a[r];0!==o[l]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},o={app:0},i=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"00cb":function(t,e,a){},"034f":function(t,e,a){"use strict";var n=a("296e"),o=a.n(n);o.a},"296e":function(t,e,a){},"29a4":function(t,e,a){"use strict";var n=a("00cb"),o=a.n(n);o.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=a("cca8"),i=a("521d"),s=a("3c97"),r=a("7049"),l=a("8b3d"),c=a("a7e2"),u=a("8c60"),d=a("cbd0"),p=a("1073"),m=a("b1fc"),h=a("44d4"),f=a("a166"),g=a("bdc5"),v=a("9ae9"),b=a("e68d"),y=a("dbbe"),w=a("f9bc"),x=a("d435"),D=a("40aa"),_=a("b519"),k=a("1f1a"),C=a("51c2"),P=a("b1e0"),S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-modal",{attrs:{centered:!0,title:t.title,"cancel-title":t.cancelTitle,"ok-title":t.okTitle},on:{ok:t.modalOk,cancel:t.modalCancel,close:t.modalClose},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[a("p",{staticClass:"my-4"},[t._v(t._s(t.message))])])},T=[],$={data:function(){return{isShow:!1,message:"default message",title:"Confirm",cancelTitle:"取消",okTitle:"确定",ok:null,cancel:null,close:null}},methods:{modalOk:function(){this.ok&&this.ok()},modalCancel:function(){this.cancel&&this.cancel()},modalClose:function(){this.close&&this.close()}}},N=$,O=a("2877"),B=Object(O["a"])(N,S,T,!1,null,null,null),j=B.exports,F={isShow:!0,message:"default message",title:"Confirm",cancelTitle:"取消",okTitle:"确定",ok:null,cancel:null,close:null},z={install:function(t){var e=t.extend(j),a=new e;a.$mount(),document.body.appendChild(a.$el),t.prototype.$confirm=function(t){Object.assign(a,F,t)}}},E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-modal",{attrs:{centered:!0,title:t.title,"cancel-title":t.cancelTitle,"ok-title":t.okTitle},on:{ok:t.modalOk,cancel:t.modalCancel,close:t.modalClose,show:t.resetModal},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[a("form",{ref:"prompt-form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[a("b-form-group",{attrs:{state:t.formState,label:t.message,"invalid-feedback":t.invalid}},[a("b-form-input",{attrs:{state:t.formState,required:""},model:{value:t.formValue,callback:function(e){t.formValue=e},expression:"formValue"}})],1)],1)])},I=[],M={data:function(){return{isShow:!1,message:"default message",title:"Confirm",cancelTitle:"取消",okTitle:"确定",ok:null,cancel:null,close:null,regex:/.+/,invalidTips:"",formValue:"",formState:null}},methods:{handleSubmit:function(){var t=this;this.formState=this.regex.test(this.formValue),this.formState&&(this.ok&&this.ok(this.formValue),this.$nextTick((function(){t.isShow=!1})))},resetModal:function(){this.formValue="",this.formState=null},modalOk:function(t){t.preventDefault(),this.handleSubmit()},modalCancel:function(){this.cancel&&this.cancel()},modalClose:function(){this.close&&this.close()}},computed:{invalid:function(){return this.invalidTips||"invalid input, expected: "+this.regex}}},L=M,U=Object(O["a"])(L,E,I,!1,null,null,null),A=U.exports,R={},V={isShow:!0,message:"default message",title:"input",cancelTitle:"取消",okTitle:"确定",ok:null,cancel:null,close:null,regex:/.+/,invalidTips:""};R.install=function(t){var e=t.extend(A),a=new e;a.$mount(),document.body.appendChild(a.$el),t.prototype.$prompt=function(t){Object.assign(a,V,t)}};var H=R;n["default"].use(o["a"]),n["default"].use(i["a"]),n["default"].use(s["a"]),n["default"].use(r["a"]),n["default"].use(l["a"]),n["default"].use(c["a"]),n["default"].use(u["a"]),n["default"].use(d["a"]),n["default"].use(p["a"]),n["default"].use(m["a"]),n["default"].use(h["a"]),n["default"].use(f["a"]),n["default"].use(g["a"]),n["default"].use(v["a"]),n["default"].use(b["a"]),n["default"].use(y["a"]),n["default"].use(w["a"]),n["default"].use(x["a"]),n["default"].use(D["a"]),n["default"].use(_["a"]),n["default"].use(k["a"]),n["default"].use(C["a"]),n["default"].use(P["a"]),n["default"].use(z),n["default"].use(H);a("f9e3"),a("2dd8");var W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"dark",sticky:""}},[a("div",{staticClass:"container"},[a("b-navbar-brand",{attrs:{href:"#"}},[a("img",{staticClass:"d-inline-block align-top",attrs:{src:"https://cdn.onesrc.cn/uploads/images/onepoint_30.png",alt:"logo"}}),t._v(" ONEPOINT ")]),a("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[a("b-navbar-nav",[a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:"/home"}},[t._v("Home")])],1),t.$store.state.isadmin?[a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:"/files"}},[t._v("Files")])],1),a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:"/setting"}},[t._v("Setting")])],1),a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:"/cache"}},[t._v("Cache")])],1),a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:"/dashboard"}},[t._v("Dashboard")])],1)]:t._e()],2),a("b-navbar-nav",{staticClass:"ml-auto"},[t.$store.state.isadmin?a("b-nav-item",{attrs:{href:"logout",right:""},on:{click:function(e){return e.preventDefault(),t.logout(e)}}},[t._v("Logout")]):a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:"/login"}},[t._v("Login")])],1)],1)],1)],1)]),a("router-view"),t._m(0)],1)},Q=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"text-muted text-center m-3"},[t._v(" Designed by "),a("a",{attrs:{href:"https://www.onesrc.cn/"}},[t._v("ONESRC")]),t._v(" | Powered by "),a("a",{attrs:{href:"https://github.com/ukuq/onepoint"}},[t._v("OnePoint")]),t._v(". ")])}],J={beforeCreate:function(){var t=window.localStorage.getItem("loginTime");t&&new Date<t&&this.$store.commit("loginSuccess")},methods:{logout:function(){this.$store.commit("logoutSuccess"),this.common.axios.get("./admin/public/logout").catch((function(){})),this.$router.push({path:"/login"})}}},G=J,q=(a("034f"),Object(O["a"])(G,W,Q,!1,null,null,null)),K=q.exports,Y=a("8c4f"),X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container mt-3"},[a("div",{staticStyle:{position:"relative"}},[a("b-icon",{directives:[{name:"b-modal",rawName:"v-b-modal.setting-modal",modifiers:{"setting-modal":!0}}],staticStyle:{position:"absolute",right:"15px",top:"15px",cursor:"pointer"},attrs:{icon:"gear-fill",scale:"1.25",variant:"primary"}}),a("b-breadcrumb",[a("b-breadcrumb-item",{on:{click:function(e){return e.preventDefault(),t.chwd("/")}}},[a("b-icon",{attrs:{icon:"house-fill",scale:"1.25","shift-v":"1.25","aria-hidden":"true"}}),t._v("Home ")],1),t._l(t.navPathArr,(function(e){return a("b-breadcrumb-item",{key:e.href,attrs:{href:e.href},on:{click:function(a){return a.preventDefault(),t.chwd(e.href)}}},[t._v(t._s(e.path))])}))],2)],1),t.aplayerData.isBusy?a("div",{staticClass:"mt-3",staticStyle:{position:"relative"}},[a("b-icon",{staticStyle:{position:"absolute",right:"5px","z-index":"1",cursor:"pointer"},attrs:{icon:"x",scale:"1.25"},on:{click:function(e){t.aplayerData.isBusy=!1}}}),a("aplayer",{attrs:{autoplay:"",list:t.audioList,music:t.aplayerData.music,repeat:t.aplayerData.repeat,shuffle:t.aplayerData.shuffle},on:{"update:music":function(e){return t.$set(t.aplayerData,"music",e)},"update:repeat":function(e){return t.$set(t.aplayerData,"repeat",e)},"update:shuffle":function(e){return t.$set(t.aplayerData,"shuffle",e)}}})],1):t._e(),a("b-table",{staticClass:"border rounded mt-2",attrs:{hover:"",responsive:"",items:t.list,fields:t.fields,"primary-key":"nameFormat","head-variant":"light","foot-variant":"null","selected-variant":"danger","per-page":t.pageData.perPage,"current-page":t.pageData.currentPage},scopedSlots:t._u([{key:"cell(nameFormat)",fn:function(e){return[1===e.item.type?[a("b-icon",{attrs:{icon:"folder",scale:"1.25","shift-h":"-3","aria-hidden":"true"}}),a("a",{attrs:{href:e.item.name+"/"},on:{click:function(a){return a.preventDefault(),t.chwd(e.item.name+"/")}}},[t._v(t._s(e.item.name)+"/")])]:3===e.item.type?[a("b-icon",{attrs:{icon:"inbox",scale:"1.25","shift-h":"-3","aria-hidden":"true"}}),a("a",{attrs:{href:e.item.name+"/"},on:{click:function(a){return a.preventDefault(),t.chwd(e.item.name+"/")}}},[t._v(t._s(e.item.name)+"/")])]:[a("b-icon",{attrs:{icon:"document",scale:"1.25","shift-h":"-3","aria-hidden":"true"}}),a("a",{staticClass:"mr-2",attrs:{href:e.item.name+"?preview"},on:{click:function(a){return a.preventDefault(),t.preview(e.item)}}},[t._v(t._s(e.item.name))]),a("a",{attrs:{href:t.common.p_h0+t.nowPath+e.item.name,target:"_blank"}},[a("b-icon",{attrs:{icon:"download",scale:"1.25","shift-h":"-3","aria-hidden":"true"}})],1)]]}},{key:"custom-foot",fn:function(){return[a("b-tr",[a("b-td",{staticClass:"py-1",staticStyle:{position:"relative"},attrs:{colspan:"3"}},[a("p",{staticClass:"mt-2",staticStyle:{position:"absolute"}},[t._v(t._s(t.siteinfo.proxy_cookie?"Proxy via: "+t.siteinfo.proxy_cookie:""))]),a("div",{staticClass:"overflow-auto",staticStyle:{display:"flex","justify-content":"flex-end"}},[a("b-pagination",{staticClass:"my-0 ml-2",attrs:{"total-rows":t.list.length,"per-page":t.pageData.perPage},model:{value:t.pageData.currentPage,callback:function(e){t.$set(t.pageData,"currentPage",e)},expression:"pageData.currentPage"}}),a("b-form-select",{staticClass:"ml-2",staticStyle:{"max-width":"100px"},attrs:{options:t.pageData.pageOptions},model:{value:t.pageData.perPage,callback:function(e){t.$set(t.pageData,"perPage",e)},expression:"pageData.perPage"}}),t.next?a("b-button",{staticClass:"ml-2",staticStyle:{"max-height":"37px"},on:{click:function(e){return t.updateList(t.nowPath,t.next)}}},[t._v(t._s(t.loadingData.isBusy?"loading...":"LoadMore"))]):t._e()],1)])],1)]},proxy:!0}])}),a("b-card",{staticClass:"mt-3",attrs:{"no-body":""}},[a("b-card-header",[t._v("README.md")]),a("b-card-body",[a("div",{domProps:{innerHTML:t._s(t.readme)}})])],1),a("b-modal",{attrs:{centered:"","hide-footer":"",title:t.dplayerData.title,size:"xl"},model:{value:t.dplayerData.isBusy,callback:function(e){t.$set(t.dplayerData,"isBusy",e)},expression:"dplayerData.isBusy"}},[a("video-player",{ref:"videoPlayer",attrs:{url:t.dplayerData.url,"vtt-url":t.dplayerData.vttUrl,path:t.dplayerData.path}})],1),a("b-modal",{attrs:{centered:"","hide-footer":"",title:t.imgData.title,size:"xl"},model:{value:t.imgData.isBusy,callback:function(e){t.$set(t.imgData,"isBusy",e)},expression:"imgData.isBusy"}},[a("b-img",{attrs:{src:t.imgData.url,fluid:"",alt:"Responsive image"}})],1),a("b-modal",{attrs:{centered:"","hide-footer":"",title:t.textData.title,size:"xl"},on:{show:t.previewText},model:{value:t.textData.isBusy,callback:function(e){t.$set(t.textData,"isBusy",e)},expression:"textData.isBusy"}},[a("pre",[a("code",{},[t._v(t._s(t.textData.text))])])]),a("b-modal",{ref:"setting",attrs:{id:"setting-modal",title:"Setting",centered:"","hide-footer":""}},[a("label",[t._v("Proxy Setting")]),a("b-form-select",{attrs:{options:t.siteinfo.proxy},on:{change:t.updateProxy},model:{value:t.siteinfo.proxy_cookie,callback:function(e){t.$set(t.siteinfo,"proxy_cookie",e)},expression:"siteinfo.proxy_cookie"}})],1)],1)},Z=[],tt=(a("99af"),a("7db0"),a("4160"),a("d81d"),a("fb6a"),a("b0c0"),a("ac1f"),a("1276"),a("2ca0"),a("159b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"dplayer"}})}),et=[],at=(a("96cf"),a("1da1")),nt=(a("eccb"),a("f7a5")),ot=a.n(nt),it={name:"VideoPlayer",data:function(){return{options:{container:null,video:{url:""},subtitle:null,autoplay:!1},player:null}},props:{url:String,vttUrl:{type:String,default:""}},mounted:function(){var t=this;return Object(at["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.options.container=document.getElementById("dplayer"),t.vttUrl&&(t.options.subtitle={url:t.vttUrl,type:"webvtt",fontSize:"25px",bottom:"10%",color:"#b7daff"}),t.player=new ot.a(t.options),t.player.switchVideo({url:t.url});case 4:case"end":return e.stop()}}),e)})))()},destroyed:function(){this.player.destroy()}},st=it,rt=(a("29a4"),Object(O["a"])(st,tt,et,!1,null,null,null)),lt=rt.exports,ct=a("0f7d"),ut=a.n(ct),dt=a("e0c1"),pt=a.n(dt),mt=(a("e4cb"),{name:"Filelister",components:{VideoPlayer:lt,aplayer:ut.a},data:function(){return{aplayerData:{isBusy:!1,music:{src:"https://google.com/404"},repeat:"no-repeat",shuffle:!1},dplayerData:{isBusy:!1,url:"",vttUrl:"",path:"",title:""},imgData:{isBusy:!1,url:"",title:""},textData:{text:"",url:"",isBusy:!1,title:""},readmeData:{text:"nothing",map:{}},nowPath:"/",listCache:{},pageData:{currentPage:1,perPage:10,pageOptions:[{text:"10/Page",value:10},{text:"50/Page",value:50}]},loadingData:{isBusy:!1,info:"default info"},fields:[{key:"nameFormat",label:"Name"},{key:"time",label:"Time",thStyle:"width:180px",class:"d-none d-md-table-cell",formatter:this.common.formatDate},{key:"size",label:"Size",thStyle:"width:120px",class:"text-right mr-3 d-none d-md-table-cell",formatter:this.common.formatSize}],siteinfo:{site_name:"",site_readme:"",proxy:[{text:"no proxy",value:""}],proxy_cookie:""}}},created:function(){this.nowPath=this.$route.params.pathMatch||"/",this.updateList(this.nowPath),this.updateTarget(this.common.p_h0)},methods:{chwd:function(t){t.startsWith("/")?this.updateList(t):this.updateList(this.nowPath+t)},updateList:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if(this.nowPath===t||(this.$router.push({path:"/home"+t}),this.nowPath=t,!this.listCache[t])){if(this.loadingData.isBusy)return this.$message("Processing other tasks, try again later","i");this.loadingData.isBusy=!0,this.loadingData.info="loading... "+t+a,console.log("try: ls "+t+a);var o=this,i=".".concat(this.common.urlSpCharEncode(t),"?json").concat(a?"&"+a.slice(1):"");this.common.axios({url:i,method:n?"post":"get",data:n}).then((function(n){o.loadingData.isBusy=!1,n.data.list?(a?(n.data.list.forEach((function(e){return o.listCache[t].list.push(e)})),o.listCache[t].next=n.data.next):o.$set(o.listCache,t,n.data),n.data.list.find((function(t){return 0===t.type&&"README.md"===t.name}))&&e.genReadme(t)):console.log(n.data)})).catch((function(e){if(o.loadingData.isBusy=!1,console.log(e),e.response){if(401!==e.response.status)return o.$message("error: "+e.response.data.info,"d");var n=e.response.data.info.split(":");o.$prompt({title:"密码验证",message:n[1],ok:function(e){var i={};i[n[0]]=e,o.updateList(t,a,i)}})}else o.$message("error: "+e.message,"d")}))}},preview:function(t){var e=this.nowPath+t.name,a=this.common.p_h0+this.common.urlSpCharEncode(e);if(t.mime.startsWith("audio"))this.aplayerData.music.src=a,this.aplayerData.isBusy=!0;else if(t.mime.startsWith("video")){this.dplayerData.url=a;var n=t.name+".vtt";this.list.find((function(t){return t.name===n}))&&(this.dplayerData.vttUrl=this.dplayerData.url+".vtt"),this.dplayerData.title=t.name,this.dplayerData.isBusy=!0}else t.mime.startsWith("image")?(this.imgData.url=a,this.imgData.title=t.name,this.imgData.isBusy=!0):t.mime.startsWith("text")?(this.textData.url=a,this.textData.title=t.name,this.textData.isBusy=!0):this.$message("该格式不支持预览","p")},previewText:function(){var t=this;this.textData.text="loading...",this.common.axios.get(this.textData.url+"?json").then((function(e){t.textData.text="loading from: "+e.data.url,t.common.axios.get(e.data.url,{withCredentials:!1,responseType:"text"}).then((function(e){t.textData.text=e.data}))})).catch((function(e){t.textData.text=e.message}))},genReadme:function(t){var e=this;this.$set(this.readmeData.map,t,"loading..."),this.common.axios.get(this.common.urlSpCharEncode(t)+"README.md?json").then((function(a){e.common.axios.get(a.data.url,{withCredentials:!1,responseType:"text"}).then((function(a){e.readmeData.map[t]=pt()(a.data)}))})).catch((function(a){e.readmeData.map[t]="loading failed:"+a.message}))},updateProxy:function(t){var e=this;this.common.axios.get("./admin/public/proxy?proxy="+encodeURIComponent(t)).then((function(){e.$message("set proxy: "+t,"i")}))},updateTarget:function(t){var e=this;this.common.axios(t+"/admin/public/site").then((function(t){e.siteinfo=t.data,e.siteinfo.proxy.unshift({text:"no proxy",value:""}),e.readmeData.text=pt()(t.data.site_readme)})).catch((function(t){e.siteinfo.proxy=[{text:"no proxy",value:""}],e.siteinfo.proxy_cookie="",e.$messgae("获取site信息失败: "+t.message,"d")}))}},computed:{navPathArr:function(){var t=this.nowPath,e="/",a=[];return t.split("/").forEach((function(t){t&&(e+=t,e+="/",a.push({path:t,href:e}))})),a},list:function(){var t=this.listCache[this.nowPath]||{list:[{type:3,name:this.loadingData.isBusy?"loading...":"loading failed",size:NaN,time:void 0,mime:""}]};return t.list},next:function(){var t=this.listCache[this.nowPath];return t&&(t=t.next),t},audioList:function(){var t=this,e=[];return this.list.forEach((function(a){0===a.type&&a.mime.startsWith("audio")&&e.push({title:a.name,src:t.common.p_h0+t.nowPath+a.name})})),e},readme:function(){return this.readmeData.map[this.nowPath]||this.readmeData.text}}}),ht=mt,ft=Object(O["a"])(ht,X,Z,!1,null,null,null),gt=ft.exports,vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"row justify-content-center mt-3"},[a("b-card",{staticClass:"col-md-5 p-0 mt-3",attrs:{header:"Login"}},[a("b-form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[a("b-form-group",{attrs:{label:"UserName"}},[a("b-form-input",{ref:"name",attrs:{trim:""},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}})],1),a("b-form-group",{attrs:{label:"Password"}},[a("b-form-input",{ref:"pass",attrs:{trim:"",type:"password"},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}})],1),a("b-button",{attrs:{variant:"primary",type:"submit",disabled:t.loading}},[t._v(t._s(t.loading?"loading...":"LOGIN"))])],1)],1)],1)])},bt=[],yt={computed:{},data:function(){return{loginForm:{username:"",password:""},loading:!1}},methods:{submit:function(){var t=this;if(!this.loginForm.username||!this.loginForm.password)return this.$message("账号或密码为空!","d");var e=this;this.loading=!0,this.common.axios.post("./admin/public/login",this.loginForm).then((function(){t.loading=!1,e.$message("登录成功","i"),window.localStorage.setItem("loginTime",(new Date).valueOf()+3e5),e.$store.commit("loginSuccess"),e.$router.push({path:"/dashboard"})})).catch((function(a){t.loading=!1,a.response?e.$message(a.response.data.info,"d"):e.$message(a.message,"d")}))}}},wt=yt,xt=Object(O["a"])(wt,vt,bt,!1,null,null,null),Dt=xt.exports,_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("b-card",{staticClass:"mt-3",attrs:{"no-body":""}},[a("b-card-header",[t._v("Dashboard")]),a("b-card-body",{staticClass:"row"},[a("div",{staticClass:"col-6",staticStyle:{display:"flex","justify-content":"center","flex-direction":"column","align-items":"center"}},[a("b-card-title",[t._v("createTime:"+t._s(t.getCTime))]),a("b-card-title",[t._v("initTime:"+t._s(t.getITime))])],1),a("div",{staticClass:"col-6"},[a("b-list-group",[a("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[t._v(" normal "),a("b-badge",{attrs:{variant:"primary",pill:""}},[t._v(t._s(t.runInfo.normal))])],1),a("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[t._v(" api "),a("b-badge",{attrs:{variant:"primary",pill:""}},[t._v(t._s(t.runInfo.api))])],1),a("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[t._v(" admin "),a("b-badge",{attrs:{variant:"primary",pill:""}},[t._v(t._s(t.runInfo.admin))])],1)],1)],1)])],1),a("b-card",{staticClass:"mt-3",attrs:{"no-body":""}},[a("b-card-header",[t._v("DriveInfo")]),a("b-card-body",{staticClass:"p-0"},[a("b-table-simple",{attrs:{hover:"",outlined:"",responsive:""}},[a("b-thead",[a("b-tr",[a("b-th",[t._v("path")]),a("b-th",[t._v("funcName")]),a("b-th",[t._v("password")])],1)],1),a("b-tbody",t._l(t.drivesInfos,(function(e){return a("b-tr",{key:e.path},[a("b-td",[t._v(t._s(e.path))]),a("b-td",[t._v(t._s(e.funcName))]),a("b-td",[e.password?[t._v(" "+t._s(e.password)+" "),a("b-dropdown",{attrs:{size:"lg",variant:"link","toggle-class":"p-0","no-caret":""},scopedSlots:t._u([{key:"button-content",fn:function(){return[a("b-icon",{attrs:{icon:"reply","aria-hidden":"true"}}),a("span",{staticClass:"sr-only"},[t._v("Share")])]},proxy:!0}],null,!0)},[a("b-dropdown-text",[t._v("Share it")]),a("b-dropdown-divider"),a("b-dropdown-item",{on:{click:function(a){return t.getShareUrl(e.path,36e5,e.password)}}},[t._v("1小时")]),a("b-dropdown-item",{on:{click:function(a){return t.getShareUrl(e.path,864e5,e.password)}}},[t._v("1天")]),a("b-dropdown-item",{on:{click:function(a){return t.getShareUrl(e.path,6048e5,e.password)}}},[t._v("1星期")])],1)]:a("span",[t._v("none")])],2)],1)})),1)],1),a("p",{staticClass:"text-center"},[a("a",{attrs:{href:t.info}},[t._v(t._s(t.info))])])],1)],1)],1)},kt=[],Ct={name:"Dashboard",data:function(){return{runInfo:{},drivesInfos:[],info:"#Share the drives with your friends"}},created:function(){var t=this;this.common.axios.get("./admin/ajax/dashboard").then((function(e){console.log(e.data),t.runInfo=e.data.runInfo,t.drivesInfos=e.data.drivesInfos}))},methods:{getShareUrl:function(t,e){var a=this;e=(new Date).valueOf()+e,a.info="loading...",a.common.axios.get("./admin/ajax/share",{params:{path:t,time:e}}).then((function(t){console.log(t.data),a.info=a.common.p_h0+t.data.url}))}},computed:{getCTime:function(){return this.common.formatDate(this.runInfo.createTime)},getITime:function(){return this.common.formatDate(this.runInfo.initTime)}},components:{}},Pt=Ct,St=Object(O["a"])(Pt,_t,kt,!1,null,null,null),Tt=St.exports,$t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container mt-3"},[a("b-breadcrumb",[a("b-breadcrumb-item",{on:{click:function(e){return t.chwd("/")}}},[a("b-icon",{attrs:{icon:"house-fill",scale:"1.25","shift-v":"1.25","aria-hidden":"true"}}),t._v("Home ")],1),t._l(t.navPathArr,(function(e){return a("b-breadcrumb-item",{key:e.href,on:{click:function(a){return t.chwd(e.href)}}},[t._v(t._s(e.path))])}))],2),a("div",{staticClass:"mt-3"},[a("b-dropdown",{attrs:{text:"Options",variant:"outline-primary"}},[a("b-dropdown-item",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-touch",modifiers:{"modal-touch":!0}}]},[t._v("New File")]),a("b-dropdown-item",{on:{click:function(e){return t.optBtnClick("mkdir")}}},[t._v("New Folder")]),a("b-dropdown-divider"),a("b-dropdown-item",{on:{click:function(e){return t.uploadBtnClick("upload-files")}}},[t._v("Upload File")]),a("b-dropdown-item",{on:{click:function(e){return t.uploadBtnClick("upload-folder")}}},[t._v("Upload Folder")])],1),a("b-button",{staticClass:"ml-2",on:{click:function(e){return t.updateList()}}},[t._v("Sync")]),a("b-button",{directives:[{name:"show",rawName:"v-show",value:t.nextToken,expression:"nextToken"}],staticClass:"ml-2",on:{click:function(e){return t.updateList(t.nowPath,t.nextToken)}}},[t._v("LoadNext")]),a("b-button",{directives:[{name:"show",rawName:"v-show",value:t.uploadData.uploadNow||t.uploadData.uploadQueue.length||t.uploadData.uploadSucess.length||t.uploadData.uploadFail.length,expression:"uploadData.uploadNow || uploadData.uploadQueue.length || uploadData.uploadSucess.length || uploadData.uploadFail.length"},{name:"b-modal",rawName:"v-b-modal.modal-upload",modifiers:{"modal-upload":!0}}],staticClass:"ml-2"},[t._v("Upload Status")]),a("b-button",{directives:[{name:"show",rawName:"v-show",value:"mv"===t.cmdType&&t.srcPath,expression:"('mv' === cmdType) && srcPath"}],staticClass:"ml-2",attrs:{variant:"primary",title:t.srcPath},on:{click:function(e){return t.optBtnClick("mv")}}},[t._v("MoveTo")]),a("b-button",{directives:[{name:"show",rawName:"v-show",value:"cp"===t.cmdType&&t.srcPath,expression:"('cp' === cmdType) && srcPath"}],staticClass:"ml-2",attrs:{variant:"primary",title:t.srcPath},on:{click:function(e){return t.optBtnClick("cp")}}},[t._v("Paste")]),a("b-button",{directives:[{name:"show",rawName:"v-show",value:t.srcPath,expression:"srcPath"}],staticClass:"ml-2",attrs:{variant:"primary"},on:{click:function(e){t.srcPath=""}}},[t._v("Cancel")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.loadingbarData.show,expression:"loadingbarData.show"}]},[a("span",{staticClass:"mx-3"},[t._v(t._s(t.loadingbarData.info))]),a("b-spinner",{staticClass:"float-right",attrs:{variant:"primary",label:"Spinning"}})],1)],1),a("b-table",{staticClass:"border rounded mt-2",attrs:{hover:"",responsive:"",id:"list-table",items:t.list,fields:t.fields,busy:t.loadingData.isBusy,"primary-key":"nameFormat","head-variant":"light","per-page":t.pageData.perPage,"current-page":t.pageData.currentPage},scopedSlots:t._u([{key:"cell(nameFormat)",fn:function(e){return[a("div",{staticClass:"opt-div"},[a("b-icon",{staticClass:"opt-icon",attrs:{icon:"command",scale:"1.25","shift-v":"1.25","aria-hidden":"true"}}),a("div",{staticClass:"opt-btns"},[a("b-button-group",{attrs:{vertical:""}},[a("b-button",{on:{click:function(a){return t.optBtnClick("rm",e.item.name)}}},[t._v("Delete")]),a("b-button",{on:{click:function(a){return t.optBtnClick("ren",e.item.name)}}},[t._v("Rename")]),a("b-button",{on:{click:function(a){return t.optBtnClick("mv_",e.item.name)}}},[t._v("Move")]),a("b-button",{on:{click:function(a){return t.optBtnClick("cp_",e.item.name)}}},[t._v("Copy")])],1)],1)],1),e.item.type?a("a",{attrs:{href:"#"},on:{click:function(a){return t.chwd(e.item.name+"/")}}},[t._v(t._s(e.item.name)+"/")]):a("span",[t._v(t._s(e.item.name))])]}},{key:"table-busy",fn:function(){return[a("div",{staticClass:"text-center text-primary my-2"},[a("b-spinner",{staticClass:"align-middle"}),a("strong",[t._v(t._s(t.loadingData.info))])],1)]},proxy:!0}])}),a("div",{staticClass:"overflow-auto",staticStyle:{display:"flex","justify-content":"flex-end"}},[a("b-pagination",{attrs:{"total-rows":t.list.length,"per-page":t.pageData.perPage,"aria-controls":"list-table"},model:{value:t.pageData.currentPage,callback:function(e){t.$set(t.pageData,"currentPage",e)},expression:"pageData.currentPage"}}),a("b-form-select",{staticClass:"mb-3 ml-2",staticStyle:{width:"100px"},attrs:{options:t.pageData.pageOptions},model:{value:t.pageData.perPage,callback:function(e){t.$set(t.pageData,"perPage",e)},expression:"pageData.perPage"}})],1),a("div",{staticClass:"fixed-bottom"},[a("b-alert",{attrs:{show:t.alertData.dismissCountDown,dismissible:"",fade:"",variant:t.alertData.type},on:{"dismiss-count-down":t.countDownChanged}},[t._v(t._s(t.alertData.info))])],1),a("b-modal",{attrs:{id:"modal-touch",size:"lg",title:"touch a new file"},on:{ok:function(e){return t.optBtnClick("touch")}}},[a("form",{ref:"form-touch",on:{submit:function(t){t.stopPropagation(),t.preventDefault()}}},[a("b-form-group",{attrs:{label:"file name:"}},[a("b-form-input",{model:{value:t.uploadData.uploadTouch.name,callback:function(e){t.$set(t.uploadData.uploadTouch,"name",e)},expression:"uploadData.uploadTouch.name"}})],1),a("b-form-group",{attrs:{label:"file content:"}},[a("b-form-textarea",{attrs:{placeholder:"here is the file content",rows:"8","max-rows":"16"},model:{value:t.uploadData.uploadTouch.content,callback:function(e){t.$set(t.uploadData.uploadTouch,"content",e)},expression:"uploadData.uploadTouch.content"}})],1)],1)]),a("b-modal",{attrs:{id:"modal-upload",size:"lg",title:"upload status",scrollable:"","hide-footer":"","hide-header":""}},[a("div",{staticClass:"container"},[t.uploadData.uploadNow?a("div",[a("p",{staticClass:"text-primary"},[t._v("now")]),t._v(" "+t._s(t.uploadData.uploadNow.file.name)+" "),a("b-progress",{attrs:{value:t.uploadData.uploadSize,max:t.uploadData.uploadNow.file.size,"show-progress":"",animated:""}})],1):t._e(),a("p",{staticClass:"text-secondary"},[t._v("waiting")]),t._l(t.uploadData.uploadQueue,(function(e){return a("p",{key:e.file.name},[t._v(" "+t._s(e.file.name)+" -- "+t._s(t.common.formatSize(e.file.size))+" -- "+t._s(e.path)+" ")])})),a("p",{staticClass:"text-danger"},[t._v("fail")]),t._l(t.uploadData.uploadFail,(function(e){return a("p",{key:e.file.name},[t._v(" "+t._s(e.file.name)+" -- "+t._s(t.common.formatSize(e.file.size))+" -- "+t._s(e.path)+" ")])})),a("p",{staticClass:"text-success"},[t._v("success")]),t._l(t.uploadData.uploadSucess,(function(e){return a("p",{key:e.file.name},[t._v(" "+t._s(e.file.name)+" -- "+t._s(t.common.formatSize(e.file.size))+" -- "+t._s(e.path)+" ")])}))],2)]),a("input",{ref:"upload-files",staticClass:"d-none",attrs:{type:"file",multiple:""},on:{change:t.uploadOnChange}}),a("input",{ref:"upload-folder",staticClass:"d-none",attrs:{type:"file",webkitdirectory:""},on:{change:t.uploadOnChange}})],1)},Nt=[],Ot=(a("baa5"),a("a434"),a("a9e3"),a("8a79"),{data:function(){return{nowPath:"/",list:[],nextToken:"",listCache:{},pageData:{currentPage:1,perPage:10,pageOptions:[{text:"10/Page",value:10},{text:"50/Page",value:50}]},srcPath:"",cmdType:"",uploadData:{uploadQueue:[],uploadSucess:[],uploadFail:[],uploadNow:null,uploadSize:0,uploadTouch:{name:"",content:""}},searchData:{text:"",parentPath:"",content:[]},loadingbarData:{show:!1,info:"default info"},loadingData:{isBusy:!1,info:"default info"},alertData:{dismissCountDown:0,type:"primary",info:"default info"},fields:[{key:"nameFormat",label:"Name"},{key:"time",label:"Time",formatter:this.common.formatDate},{key:"size",label:"Size",class:"text-right",formatter:this.common.formatSize}]}},created:function(){this.updateList()},methods:{chwd:function(t){t.startsWith("/")?this.updateList(t):this.updateList(this.nowPath+t)},loadNextContent:function(t){console.log(t)},updateList:function(t,e){var a,n=this;return t||(t=this.nowPath,a=!0),!this.listCache[t]||a||e?this.loadingData.isBusy?this.showAlert("Processing other tasks, try again later","w"):(this.loadingData.isBusy=!0,this.loadingData.info="loading... "+t,console.log("try: ls "+t+(e?"?spPage="+e:"")),void this.common.axios.post("./api/cmd",{cmdType:"ls",cmdData:{path:t,spPage:e}}).then((function(a){n.loadingData.isBusy=!1,console.log(a.data),a.data.list?(n.nowPath=t,e?(a.data.list.forEach((function(e){return n.listCache[t].list.push(e)})),n.listCache[t].nextToken=a.data.nextToken):n.listCache[t]=a.data,n.list=n.listCache[t].list,n.nextToken=a.data.nextToken):console.log(a.data)})).catch((function(t){n.loadingData.isBusy=!1,console.log(t),void 0!==t.response?401===t.response.status?n.$router.push({path:"/login"}):n.showAlert("error: "+t.response.data.info,"d"):n.showAlert("error: "+t.message,"d")}))):(this.list=this.listCache[t].list,this.nextToken=this.listCache[t].nextToken,void(this.nowPath=t))},sendCmd:function(t,e){var a=this,n=this,o=i();function i(){switch(t){case"mkdir":return"mkdir "+e.path+e.name;case"mv":case"cp":return t+" "+e.srcPath+" "+e.desPath;case"rm":return"rm "+e.path;case"ren":return"ren "+e.path+" "+e.name;case"touch":case"upload":return t+" "+e.path+(e.name||"");case"find":return t+" "+e.path+" "+e.text;default:return"unknown: "+t}}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";t.endsWith("/")&&(t=t.slice(0,-1));var e=t.lastIndexOf("/")+1;return{path:t.slice(0,e),name:t.slice(e)}}console.log("try: "+o),this.loadingbarData.info=o,this.loadingbarData.show=!0,this.common.axios.post("./api/cmd",{cmdType:t,cmdData:e}).then((function(o){var i,r,l,c;switch(a.loadingbarData.show=!1,t){case"mkdir":return void n.listCache[e.path].list.unshift({type:1,name:e.name,size:0,mime:"",time:n.common.formatDate(new Date)});case"mv":case"cp":return i=s(e.srcPath),r=-1,l=n.listCache[i.path].list.find((function(t,e){return r=e,t.name===i.name})),"mv"===t&&n.listCache[i.path].list.splice(r,1),void n.listCache[e.desPath].list.unshift(l);case"rm":case"ren":return i=s(e.path),r=-1,l=n.listCache[i.path].list.find((function(t,e){return r=e,t.name===i.name})),void("rm"===t?n.listCache[i.path].list.splice(r,1):l.name=e.name);case"touch":return void n.listCache[e.path].list.unshift({type:0,name:e.name,size:n.common.formatSize(e.content.length),mime:"onepoint/unknown",time:n.common.formatDate(new Date)});case"upload":return c=o.data.json.uploadUrl,void n.common.axios.get(c,{withCredentials:!1}).then((function(t){n.fileUpload(t.data,c)}));case"find":return n.nowPath=o.data.parentPath,void(n.content=o.data.data.content);default:return void console.log("unknown: "+t)}})).catch((function(e){n.loadingbarData.show=!1,console.log(e),void 0!==e.response?n.showAlert("error: "+e.response.data.info,"d"):n.showAlert("error: "+e.message,"d"),"upload"===t&&n.uploadData.uploadNow&&(n.uploadData.uploadFail.unshift(n.uploadData.uploadNow),n.uploadData.uploadNow=null)}))},optBtnClick:function(t){var e,a=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=this.nowPath+n,i=this;switch(t){case"mkdir":return void this.$prompt({title:"mkdir",message:"make dir in: "+o,ok:function(e){i.sendCmd(t,{path:o,name:e})}});case"mv_":return this.cmdType="mv",void(this.srcPath=o);case"mv":if(!this.srcPath||this.srcPath.slice(0,this.srcPath.lastIndexOf("/")+1)===this.nowPath)return;return void this.$confirm({title:"mv",message:"move :"+this.srcPath+" -> "+this.nowPath,ok:function(){i.sendCmd(t,{srcPath:a.srcPath,desPath:a.nowPath}),i.srcPath=""}});case"cp_":return this.cmdType="cp",void(this.srcPath=o);case"cp":if(!this.srcPath||this.srcPath.slice(0,this.srcPath.lastIndexOf("/")+1)===this.nowPath)return;return void this.$confirm({title:"cp",message:"copy :"+this.srcPath+" -> "+this.nowPath,ok:function(){i.sendCmd(t,{srcPath:a.srcPath,desPath:a.nowPath}),i.srcPath=""}});case"rm":return void this.$confirm({title:"rm",message:"remove: "+o,ok:function(){i.sendCmd(t,{path:o})}});case"ren":return void this.$prompt({title:"ren",message:"rename: "+o,ok:function(e){i.sendCmd(t,{path:o,name:e})}});case"touch":if(!this.uploadData.uploadTouch.name)return;return this.sendCmd(t,{path:this.nowPath,name:this.uploadData.uploadTouch.name,content:this.uploadData.uploadTouch.content||""}),this.uploadData.uploadTouch.name="",void(this.uploadData.uploadTouch.content="");case"upload":if(this.uploadData.uploadNow||0===this.uploadData.uploadQueue.length)return;return this.uploadData.uploadNow=this.uploadData.uploadQueue.shift(),e=this.uploadData.uploadNow,void this.sendCmd(t,{path:e.path+e.file.name,fileSystemInfo:{lastModifiedDateTime:e.file.lastModifiedDate.toISOString()}});case"find":return void this.sendCmd(t,{path:this.nowPath,text:this.searchData.text});default:return void console.log("err: "+t)}},showAlert:function(t,e){this.alertData.dismissCountDown=5,this.alertData.type={i:"info",d:"danger",s:"success",w:"warning"}[e]||"primary",this.alertData.info=t},countDownChanged:function(t){this.alertData.dismissCountDown=t},uploadBtnClick:function(t){this.$refs[t].click()},uploadOnChange:function(t){console.log(t.target.files);for(var e=t.target.files,a=0;a<e.length;a++)this.uploadData.uploadQueue.push({path:this.nowPath,file:e[a],time:new Date})},fileUpload:function(t,e){var a,n,o,i,s=this;i=this.uploadData.uploadNow.file;var r=t.nextExpectedRanges[0].split("-");a=Number(r[0]),n=r[1]?Number(r[1])+1:i.size,o=e||t.uploadUrl,n>a+10485760&&(n=a+10485760);var l=new FileReader;l.readAsArrayBuffer(i.slice(a,n)),l.onload=function(e){console.log("send: ["+a+","+n+")"),s.common.axios.put(o,e.target.result,{headers:{"Content-Range":"bytes ".concat(a,"-").concat(n-1,"/").concat(i.size)},onUploadProgress:function(t){var e=t.loaded;s.uploadData.uploadSize=a+e},withCredentials:!1}).then((function(e){if(console.log(e.data),console.log("success: ["+a+","+n+")"),201===e.status)return s.listCache[s.uploadData.uploadNow.path].list.unshift({type:0,name:s.uploadData.uploadNow.file.name,size:s.common.formatSize(s.uploadData.uploadNow.file.size),mime:"onepoint/unknown",time:s.common.formatDate(s.uploadData.uploadNow.file.lastModifiedDate)}),s.showAlert("success: upload"+s.uploadData.uploadNow.file.name,"i"),console.log("success: "+JSON.stringify(t)),s.uploadData.uploadSucess.push(s.uploadData.uploadNow),void(s.uploadData.uploadNow=null);if(202!==e.status)throw e;s.fileUpload(e.data,o)})).catch((function(t){console.log(t),s.showAlert("error: "+t.message,"d"),s.uploadData.uploadNow&&(console.error("fail: upload "+i.name),s.uploadData.uploadFail.unshift(s.uploadData.uploadNow),s.uploadData.uploadNow=null)}))}}},computed:{navPathArr:function(){var t=this.nowPath,e="/",a=[];return t.split("/").forEach((function(t){t&&(e+=t,e+="/",a.push({path:t,href:e}))})),a}},beforeUpdate:function(){this.uploadData.uploadNow||this.optBtnClick("upload")}}),Bt=Ot,jt=(a("f50a"),Object(O["a"])(Bt,$t,Nt,!1,null,null,null)),Ft=jt.exports,zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container mt-3"},[a("b-form-input",{attrs:{placeholder:"Search"},model:{value:t.keyText,callback:function(e){t.keyText=e},expression:"keyText"}}),a("b-table",{staticClass:"border rounded mt-3",attrs:{hover:"",responsive:"",items:t.cacheFilter,fields:t.fields,"head-variant":"light","per-page":t.perPage,"current-page":t.currentPage}}),a("div",{staticClass:"overflow-auto",staticStyle:{display:"flex","justify-content":"flex-end"}},[a("b-pagination",{attrs:{"total-rows":t.cacheFilter.length,"per-page":t.perPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}),a("b-form-select",{staticClass:"mb-3 ml-2",staticStyle:{width:"100px"},attrs:{options:t.pageOptions},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1)},Et=[],It=(a("4de4"),a("caad"),a("2532"),{data:function(){return{cache:[],keyText:"",fields:["path",{key:"data",formatter:JSON.stringify}],currentPage:1,perPage:10,pageOptions:[{text:"10/Page",value:10},{text:"50/Page",value:50}]}},beforeCreate:function(){var t=this;this.common.axios.get("./admin/ajax/cache").then((function(e){t.cache=e.data})).catch((function(e){t.cache.push({path:"error",data:e})}))},methods:{},computed:{cacheFilter:function(){var t=this;return this.keyText?this.cache.filter((function(e){return e.path.includes(t.keyText)})):this.cache}}}),Mt=It,Lt=Object(O["a"])(Mt,zt,Et,!1,null,null,null),Ut=Lt.exports,At=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"my-3"},[a("b-button",{staticStyle:{"min-width":"80px"},attrs:{href:"#",variant:"primary"},on:{click:function(e){t.editable=!t.editable}}},[t._v(t._s(t.editable?"取消":"编辑"))]),a("b-button",{staticClass:"mx-3",staticStyle:{"min-width":"80px"},attrs:{href:"#",variant:"danger",disabled:!t.editable},on:{click:t.saveConfig}},[t._v("保存")]),a("p",{staticClass:"d-inline"},[t._v("谨慎使用，除非你知道到底在做什么")])],1),a("b-form-textarea",{attrs:{id:"textarea",placeholder:"Enter something...",rows:"50",disabled:!t.editable},model:{value:t.config,callback:function(e){t.config=e},expression:"config"}})],1)},Rt=[],Vt={data:function(){return{config:"default info",editable:!1}},created:function(){var t=this;this.common.axios.get("./admin/ajax/setting").then((function(e){console.log(e.data),t.config=JSON.stringify(e.data,null,2)}))},methods:{saveConfig:function(){var t;try{if(t=JSON.parse(this.config),!t.G_CONFIG||!t.DRIVE_MAP)return alert("invalid config")}catch(e){return alert("invalid json")}this.common.axios.post("./admin/ajax/save",t).then((function(t){alert(t.data.info)})).catch((function(t){console.log(t),alert("failed")}))}}},Ht=Vt,Wt=Object(O["a"])(Ht,At,Rt,!1,null,null,null),Qt=Wt.exports;n["default"].use(Y["a"]);var Jt=[{path:"/dashboard",name:"Dashboard",component:Tt},{path:"/files",name:"Files",component:Ft},{path:"/cache",name:"Cache",component:Ut},{path:"/setting",name:"Setting",component:Qt},{path:"/home*",name:"Home",component:gt},{path:"/login",name:"Login",component:Dt},{path:"/*",name:"Home1",component:gt}],Gt=new Y["a"]({routes:Jt}),qt=Gt,Kt=a("2f62");n["default"].use(Kt["a"]);var Yt=new Kt["a"].Store({state:{isadmin:!1},mutations:{loginSuccess:function(t){t.isadmin=!0},logoutSuccess:function(t){window.localStorage.removeItem("loginTime"),t.isadmin=!1}},actions:{},modules:{}}),Xt=(a("b680"),a("bc3a")),Zt=a.n(Xt),te={p_h0:window.p_h0,axios:Zt.a.create({baseURL:window.p_h0+"/",withCredentials:!0}),formatDate:function(t){var e=new Date(t);if("Invalid Date"==e)return e;var a=e.getFullYear(),n=e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,o=e.getDate()<10?"0"+e.getDate():e.getDate(),i=e.getHours()<10?"0"+e.getHours():e.getHours(),s=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),r=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),l=a+"-"+n+"-"+o+" "+i+":"+s+":"+r;return l},formatSize:function(t){"number"!==typeof t&&(t=NaN);var e=0;while(t>=1024)t/=1024,e++;return t=t.toFixed(2),t+=[" B"," KB"," MB"," GB"][e],t},urlSpCharEncode:function(t){if(!t)return t;for(var e="",a=t.length,n=0;n<a;n++){var o=t[n];switch(o){case"%":e+="%25";break;case"?":e+="%3f";break;case"#":e+="%23";break;case" ":e+="%20";break;default:e+=o}}return e}},ee=te;n["default"].config.productionTip=!1,n["default"].prototype.common=ee;var ae=new n["default"]({router:qt,store:Yt,render:function(t){return t(K)}}).$mount("#app");n["default"].prototype.$message=function(t,e,a){e={i:"info",d:"danger",s:"success",w:"warning"}[e]||"primary",ae.$bvToast.toast(t,{title:a||e,variant:e,solid:!0})},console.log("200322 测试版本,如果发现问题请到 github 反馈"),console.log("github: https://github.com/ukuq/onepoint")},a66a:function(t,e,a){},f50a:function(t,e,a){"use strict";var n=a("a66a"),o=a.n(n);o.a}});
//# sourceMappingURL=app.18ab85b8.js.map